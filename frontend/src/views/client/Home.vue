<template>
    <!-- offer section -->
    <section class="offer_section layout_padding-bottom">
        <div class="offer_container">
            <div class="container ">
                <div class="row">
                    <div class="col-md-6  ">
                        <div class="box ">
                            <div class="img-box">
                                <img :src="Img1" alt="">
                            </div>
                            <div class="detail-box">
                                <h5>
                                    Tasty Thursdays
                                </h5>
                                <h6>
                                    <span>20%</span> Off
                                </h6>
                                <a href="">
                                    Order Now <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                        viewBox="0 0 456.029 456.029" style="enable-background:new 0 0 456.029 456.029;"
                                        xml:space="preserve">
                                        <g>
                                            <g>
                                                <path d="M345.6,338.862c-29.184,0-53.248,23.552-53.248,53.248c0,29.184,23.552,53.248,53.248,53.248
                     c29.184,0,53.248-23.552,53.248-53.248C398.336,362.926,374.784,338.862,345.6,338.862z" />
                                            </g>
                                        </g>
                                        <g>
                                            <g>
                                                <path d="M439.296,84.91c-1.024,0-2.56-0.512-4.096-0.512H112.64l-5.12-34.304C104.448,27.566,84.992,10.67,61.952,10.67H20.48
                     C9.216,10.67,0,19.886,0,31.15c0,11.264,9.216,20.48,20.48,20.48h41.472c2.56,0,4.608,2.048,5.12,4.608l31.744,216.064
                     c4.096,27.136,27.648,47.616,55.296,47.616h212.992c26.624,0,49.664-18.944,55.296-45.056l33.28-166.4
                     C457.728,97.71,450.56,86.958,439.296,84.91z" />
                                            </g>
                                        </g>
                                        <g>
                                            <g>
                                                <path d="M215.04,389.55c-1.024-28.16-24.576-50.688-52.736-50.688c-29.696,1.536-52.224,26.112-51.2,55.296
                     c1.024,28.16,24.064,50.688,52.224,50.688h1.024C193.536,443.31,216.576,418.734,215.04,389.55z" />
                                            </g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6  ">
                        <div class="box ">
                            <div class="img-box">
                                <img :src="Img2" alt="">
                            </div>
                            <div class="detail-box">
                                <h5>
                                    Pizza Days
                                </h5>
                                <h6>
                                    <span>15%</span> Off
                                </h6>
                                <a href="">
                                    Order Now <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                        viewBox="0 0 456.029 456.029" style="enable-background:new 0 0 456.029 456.029;"
                                        xml:space="preserve">
                                        <g>
                                            <g>
                                                <path d="M345.6,338.862c-29.184,0-53.248,23.552-53.248,53.248c0,29.184,23.552,53.248,53.248,53.248
                     c29.184,0,53.248-23.552,53.248-53.248C398.336,362.926,374.784,338.862,345.6,338.862z" />
                                            </g>
                                        </g>
                                        <g>
                                            <g>
                                                <path d="M439.296,84.91c-1.024,0-2.56-0.512-4.096-0.512H112.64l-5.12-34.304C104.448,27.566,84.992,10.67,61.952,10.67H20.48
                     C9.216,10.67,0,19.886,0,31.15c0,11.264,9.216,20.48,20.48,20.48h41.472c2.56,0,4.608,2.048,5.12,4.608l31.744,216.064
                     c4.096,27.136,27.648,47.616,55.296,47.616h212.992c26.624,0,49.664-18.944,55.296-45.056l33.28-166.4
                     C457.728,97.71,450.56,86.958,439.296,84.91z" />
                                            </g>
                                        </g>
                                        <g>
                                            <g>
                                                <path d="M215.04,389.55c-1.024-28.16-24.576-50.688-52.736-50.688c-29.696,1.536-52.224,26.112-51.2,55.296
                     c1.024,28.16,24.064,50.688,52.224,50.688h1.024C193.536,443.31,216.576,418.734,215.04,389.55z" />
                                            </g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                        <g>
                                        </g>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- end offer section -->

    <!-- food section -->

    <section class="food_section layout_padding-bottom">
        <div class="container">
            <div class="heading_container heading_center">
                <h2>Our Menu</h2>
            </div>

            <!-- B·ªô l·ªçc danh m·ª•c -->
            <ul class="filters_menu">
                <li :class="{ active: activeFilter === 'all' }" @click="setFilter('all')">All</li>
                <li v-for="cat in categories" :key="cat.id" :class="{ active: activeFilter === cat.name.toLowerCase() }"
                    @click="setFilter(cat.name.toLowerCase())">
                    {{ cat.name }}
                </li>
            </ul>

            <!-- Danh s√°ch m√≥n ƒÉn -->
            <div class="filters-content">
                <div class="row grid">
                    <MotionGroup :initial="{ opacity: 0, y: 30 }"
                        :enter="{ opacity: 1, y: 0 }" :leave="{ opacity: 0, y: -30 }">
                        <FoodCard v-for="foodChildren in filteredFoods" :key="foodChildren.id" :food="foodChildren"
                            @add-to-cart="addToCart" class="col-sm-6 col-lg-4" />
                    </MotionGroup>
                </div>
            </div>

            <div class="btn-box">
                <RouterLink :to="{ name: 'Menu' }" style='text-decoration: none'>View More</RouterLink>
            </div>
        </div>
    </section>

    <!-- end food section -->

    <!-- about section -->

    <section class="about_section layout_padding">
        <div class="container  ">

            <div class="row">
                <div class="col-md-6 ">
                    <div class="img-box">
                        <img :src="Img12" alt="">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="detail-box">
                        <div class="heading_container">
                            <h2>
                                We Are Feane
                            </h2>
                        </div>
                        <p>
                            There are many variations of passages of Lorem Ipsum available, but the majority have
                            suffered alteration
                            in some form, by injected humour, or randomised words which don't look even slightly
                            believable. If you
                            are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything
                            embarrassing hidden in
                            the middle of text. All
                        </p>
                        <a href="">
                            Read More
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- end about section -->

    <!-- client section -->

    <section class="client_section layout_padding-bottom mt-5">
        <div class="container">
            <div class="heading_container heading_center psudo_white_primary mb_45">
                <h2>What Says Our Customers</h2>
            </div>

            <Splide :options="splideOptions" class="client-carousel">
                <SplideSlide v-for="(item, index) in testimonials" :key="index">
                    <div class="box">
                        <div class="detail-box">
                            <p>{{ item.text }}</p>
                            <h6>{{ item.name }}</h6>
                            <p>{{ item.subtitle }}</p>
                        </div>
                        <div class="img-box">
                            <img :src="item.image" alt="" class="box-img" />
                        </div>
                    </div>
                </SplideSlide>
            </Splide>
        </div>
    </section>


    <!-- end client section -->
</template>
<script setup>
import { Splide, SplideSlide } from '@splidejs/vue-splide'
import '@splidejs/vue-splide/css' // CSS m·∫∑c ƒë·ªãnh
import Img1 from '@/assets/images/o1.jpg';
import Img2 from '@/assets/images/o2.jpg';
import Img12 from '@/assets/images/about-img.png';
import Img13 from '@/assets/images/client1.jpg'
import Img14 from '@/assets/images/client2.jpg'
import { ref, computed, onMounted } from 'vue'
import api from '@/services/api'
import FoodCard from '@/components/client/FoodCard.vue'
import { useToast } from 'vue-toastification'
import { RouterLink } from 'vue-router';
import { useRouter } from 'vue-router';
const testimonials = [
  {
    text: 'Lorem ipsum dolor sit amet...',
    name: 'Moana Michell',
    subtitle: 'magna aliqua',
    image: Img13,
  },
  {
    text: 'Sed do eiusmod tempor incididunt...',
    name: 'Mike Hamell',
    subtitle: 'magna aliqua',
    image: Img14,
  },
  {
    text: 'Ut enim ad minim veniam...',
    name: 'Nnba',
    subtitle: 'magna aliqua',
    image: Img14,
  },
]
const splideOptions = {
  type: 'loop',
  perPage: 3,
  autoplay: true,
  interval: 2500,
  pauseOnHover: false,
  pauseOnFocus: false,
  arrows: false,
  pagination: false,
  gap: '1rem',
  breakpoints: {
    992: { perPage: 2 },
    768: { perPage: 1 },
  },
}

const toast = useToast()
const foods = ref([])
const categories = ref([])
const activeFilter = ref('all')
const router = useRouter()
// üß† Hi·ªÉn th·ªã 9 s·∫£n ph·∫©m (v√† v·∫´n l·ªçc ƒë∆∞·ª£c theo danh m·ª•c)
const filteredFoods = computed(() => {
    let result = foods.value
    if (activeFilter.value !== 'all') {
        result = result.filter(f => f.category?.name?.toLowerCase() === activeFilter.value)
    }
    return result.slice(0, 6) // üëâ ch·ªâ l·∫•y 9 s·∫£n ph·∫©m ƒë·∫ßu ti√™n
})

const setFilter = (filter) => {
    activeFilter.value = filter
}

const fetchFoods = async () => {
    try {
        const res = await api.get('/foods-client')
        foods.value = res.data.data
        categories.value = res.data.data
            .map(f => f.category)
            .filter((cat, index, self) => cat && index === self.findIndex(c => c.id === cat.id))
    } catch (err) {
        toast.error('Kh√¥ng th·ªÉ t·∫£i menu!')
    }
}

const addToCart = (food) => {
    // toast.success(`ƒê√£ th√™m ${food.name} v√†o gi·ªè h√†ng!`)
    router.push({ name: 'foodDetail', params: { id: food.id } })
}

onMounted(fetchFoods)
</script>
<style>
.client_section .box {
    display: flex;
    align-items: center;
    /* cƒÉn gi·ªØa d·ªçc */
    justify-content: space-between;
    gap: 20px;
    /* kho·∫£ng c√°ch gi·ªØa text v√† ·∫£nh */
}

.client_section .box .detail-box {
    flex: 1;
    /* chi·∫øm ph·∫ßn c√≤n l·∫°i */
}

.client_section .box .img-box {
    flex: 0 0 150px;
    /* ho·∫∑c d√πng width % n·∫øu mu·ªën */
}

.client_section .box .img-box img {
    max-width: 100%;
    display: block;
    border-radius: 8px;
    /* th√™m n·∫øu mu·ªën bo g√≥c */
}
</style>